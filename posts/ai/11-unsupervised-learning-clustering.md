---
title: "教師なし学習：クラスタリング"
date: "2025-6-29"
category: "ai-course"
section: "ai"
slug: "11-unsupervised-learning-clustering"
difficulty: "beginner"
number: 11
---

Amazonはどうやって「あなたにおすすめの商品」を見つけているのでしょうか？Netflixはどうやって似たような好みを持つユーザーを特定しているのでしょうか？これらのサービスの背景には **クラスタリング** という技術があります。正解が分からない状況でも、データの中に隠れているグループや構造を自動的に発見する **教師なし学習** について、その代表的な手法であるクラスタリングを中心に詳しく解説します。

## 教師なし学習とは？

**教師なし学習とは、「正解」が分からないデータから、隠れたパターンや構造を自動的に発見する学習方式** です。教師あり学習が「答えを教えながら学習させる方法」だったのに対し、教師なし学習は「答えを教えずに、データの中からルールや法則を見つけ出す方法」です。

### 教師あり学習との違い

**教師あり学習**：
```
入力データ + 正解ラベル → 学習 → 予測モデル
```
例：「この画像は猫」「この画像は犬」と教えて学習

**教師なし学習**：
```
入力データのみ → 学習 → データの構造発見
```
例：大量の動物の画像を見せて、「似ているもの同士を自動的にグループ分けしてください」

要するに、教師なし学習は「正解を教えない」状況で、コンピュータが自分でデータの特徴や関係性を発見する技術です。

## クラスタリングの基本概念

**クラスタリングとは、似ているデータ同士を自動的にグループ（クラスタ）に分ける技術** です。人間が手作業で分類するのではなく、コンピュータがデータの類似性を計算して、自動的にグループ分けを行います。

### クラスタリングの身近な例

**顧客分析**：
- 購買履歴から顧客を自動分類
- 「高額商品好き」「価格重視」「ブランド重視」のグループを発見

**音楽ストリーミング**：
- ユーザーの再生履歴から音楽の好みをグループ分け
- 「ロック好き」「クラシック好き」「J-POP好き」を自動認識

**市場調査**：
- アンケートデータから消費者の価値観をグループ分け
- 「健康志向」「価格志向」「ブランド志向」などを発見

**SNS分析**：
- ユーザーの投稿内容から興味関心をグループ分け
- 「スポーツ」「グルメ」「旅行」「ファッション」などのコミュニティを自動検出

## k-means法：最も基本的なクラスタリング

**k-means法** は、クラスタリングの最も代表的な手法です。事前に決めたグループ数（k個）に、データを自動的に分類します。

### k-means法の基本的な仕組み

**ステップ1：グループ数を決める**
「何個のグループに分けたいか」を最初に決めます。

**ステップ2：ランダムに中心点を配置**
各グループの「中心」となる点をランダムに配置します。

**ステップ3：最も近い中心点にデータを割り当て**
それぞれのデータを、最も近い中心点のグループに割り当てます。

**ステップ4：中心点を更新**
各グループに属するデータの平均位置を計算し、中心点を移動します。

**ステップ5：収束するまで繰り返し**
中心点が動かなくなるまで、ステップ3と4を繰り返します。

### 具体例：顧客セグメンテーション

**ある小売店の顧客分析**：
- **データ**：顧客の「年間購入金額」と「来店頻度」
- **目標**：顧客を3つのグループに分類

**結果**：
- **グループ1（優良顧客）**：高額購入、高頻度来店
- **グループ2（一般顧客）**：中程度購入、中程度来店
- **グループ3（低頻度顧客）**：低額購入、低頻度来店

この分析により、それぞれのグループに適したマーケティング戦略を立てることができます。

### k-means法の長所と短所

**長所**：
- 理解しやすく、実装が簡単
- 計算が高速で大量データにも対応
- 結果が安定している

**短所**：
- 事前にグループ数を決める必要がある
- 球状のクラスタしか見つけられない
- 外れ値に敏感

## 協調フィルタリング：推薦システムの核心技術

**協調フィルタリング** は、「似た好みを持つユーザー同士は、他の商品の好みも似ている」という考えに基づく推薦技術です。これは一種のクラスタリング技術として捉えることができます。

### 協調フィルタリングの基本的な考え方

**「類は友を呼ぶ」の原理**：
あなたと似たような商品を好む人が他にいるなら、その人が好きな別の商品も、あなたが気に入る可能性が高いはずです。

### ユーザーベース協調フィルタリング

**仕組み**：
1. あなたと似た好みを持つユーザーを見つける
2. そのユーザーが高評価した商品を推薦

**たとえば、映画推薦の場合**：
- **あなた**：「アベンジャーズ」「スパイダーマン」「アイアンマン」が好き
- **ユーザーA**：「アベンジャーズ」「スパイダーマン」「アイアンマン」「バットマン」が好き
- **推薦**：ユーザーAと似た好みなので、「バットマン」を推薦

### アイテムベース協調フィルタリング

**仕組み**：
1. あなたが好きな商品と似ている商品を見つける
2. その類似商品を推薦

**たとえば、音楽推薦の場合**：
- **あなたが好きな曲**：「Bohemian Rhapsody」（Queen）
- **類似した曲**：「Don't Stop Me Now」（Queen）、「We Will Rock You」（Queen）
- **推薦**：Queenの他の楽曲を推薦

### 実際の応用例

**Amazon の「この商品を買った人はこんな商品も買っています」**：
- 何百万人もの購買データから、商品間の関連性を分析
- 類似した購買パターンを持つ顧客グループを特定
- 統計的に「一緒に買われやすい商品」を推薦

**Netflix の番組推薦**：
- ユーザーの視聴履歴と評価データを分析
- 似た好みを持つユーザーグループを自動検出
- そのグループが高評価した番組を推薦

**Spotify の音楽推薦**：
- 再生履歴、スキップ行動、いいね行動を分析
- 音楽の好みが似ているユーザーをクラスタリング
- 新しい楽曲やアーティストを発見して推薦

## その他のクラスタリング手法

### 階層クラスタリング

**階層クラスタリング** は、データを段階的にグループ化する手法です。最終的に「デンドログラム」と呼ばれる樹形図を作成します。

**特徴**：
- 事前にグループ数を決める必要がない
- どのレベルでグループを切るかを後から決められる
- 結果が視覚的に分かりやすい

**応用例**：
- **生物学**：種の進化系統樹の作成
- **社会学**：地域社会のコミュニティ構造分析
- **マーケティング**：商品カテゴリの階層分析

### DBSCAN（密度ベースクラスタリング）

**DBSCAN** は、データの密度に基づいてクラスタを発見する手法です。

**特徴**：
- 事前にグループ数を決める必要がない
- 任意の形状のクラスタを発見できる
- 外れ値（ノイズ）を自動的に検出

**応用例**：
- **都市計画**：人口密度に基づく地域区分
- **異常検知**：正常データのクラスタから外れた異常値を検出
- **画像処理**：類似色の領域をグループ化

## クラスタリングの実際の応用

### マーケティング：顧客セグメンテーション

**目的**：効果的なマーケティング戦略の立案

**分析データ**：
- 購買履歴：何を、いつ、いくらで買ったか
- デモグラフィック情報：年齢、性別、居住地域、職業
- 行動データ：ウェブサイト閲覧履歴、メール開封率

**発見されるクラスタの例**：
- **プレミアム顧客**：高額商品を頻繁に購入、ブランド志向
- **バリュー顧客**：価格重視、セール時によく購入
- **トレンド顧客**：新商品に敏感、SNSでの情報収集が多い
- **ロイヤル顧客**：特定ブランドに愛着、リピート購入が多い

**マーケティング戦略**：
- プレミアム顧客：限定商品、VIP待遇
- バリュー顧客：割引クーポン、まとめ買い特典
- トレンド顧客：新商品情報の先行配信
- ロイヤル顧客：ブランド関連イベント招待

### 医療：疾患のサブタイプ発見

**目的**：同じ病名でも異なる特徴を持つ患者グループの発見

**分析データ**：
- 遺伝子発現データ
- 臨床検査値
- 症状の重篤度
- 治療反応性

**発見される患者クラスタの例**：
- **タイプA**：特定の遺伝子変異あり、薬物Xに良く反応
- **タイプB**：炎症マーカーが高い、免疫療法が有効
- **タイプC**：軽症だが慢性化しやすい、生活習慣改善が重要

**医療への貢献**：
- 個別化医療の実現
- 治療効果の向上
- 副作用リスクの削減

### 都市計画：地域特性の分析

**目的**：効果的な都市開発・行政サービスの提供

**分析データ**：
- 人口密度、年齢構成
- 交通量、通勤パターン
- 商業施設の分布
- 犯罪発生率、事故発生率

**発見される地域クラスタの例**：
- **商業地区**：商業施設密集、昼間人口が多い
- **住宅地区**：ファミリー層中心、公園・学校が多い
- **オフィス街**：平日昼間の人口が多い、夜間は静か
- **学生街**：若年層が多い、飲食店・娯楽施設が密集

**都市計画への活用**：
- 交通インフラの最適配置
- 行政サービスの効率的な提供
- 災害対策の地域別カスタマイズ

## クラスタリングの評価と課題

### クラスタリング結果の評価

正解ラベルがないため、クラスタリングの「良し悪し」を評価するのは困難です。

**内部評価指標**：
- **クラスタ内の密度**：同じクラスタ内のデータがどのくらい似ているか
- **クラスタ間の分離度**：異なるクラスタがどのくらい離れているか

**外部評価（ビジネス価値）**：
- 発見されたクラスタが実際のビジネスに役立つか
- ドメイン専門家から見て意味のあるグループ分けか

### 主な課題

**適切なクラスタ数の決定**：
- k-means法では事前にグループ数を決める必要がある
- エルボー法、シルエット法などで最適数を推定

**高次元データの処理**：
- 特徴量が多すぎると「次元の呪い」が発生
- 重要な特徴量の選択や次元削減が必要

**スケールの違い**：
- 「年収（万円単位）」と「年齢（歳）」のようにスケールが異なる特徴量の扱い
- 正規化・標準化の前処理が重要

## まとめ

クラスタリングは、正解のないデータから有用な構造を発見する強力な技術です。現代のデジタル社会では、顧客理解、推薦システム、科学研究など、あらゆる分野で活用されています。

**クラスタリングの本質**：
- 正解ラベルなしでデータの構造を発見
- 似ているものを自動的にグループ化
- 人間では気づけない隠れたパターンを発見

**主要な手法**：
- **k-means法**：最も基本的で実用的
- **協調フィルタリング**：推薦システムの基盤技術
- **階層クラスタリング**：段階的なグループ化
- **DBSCAN**：任意形状のクラスタを発見

**実用的な価値**：
- 顧客セグメンテーション、疾患分類、地域分析
- マーケティング戦略、個別化医療、都市計画
- ビジネス理解の深化と意思決定支援

**重要な課題**：
- 適切なクラスタ数の決定
- 高次元データや異なるスケールの特徴量への対処
- ビジネス価値のあるクラスタの発見

要するに、クラスタリングは「データに隠れているグループを自動的に見つけ出し、新しい視点や理解を提供する」技術であり、データドリブンな意思決定の基盤となっています。

次回は、同じ教師なし学習でも **次元削減** について、高次元データを扱いやすい形に変換する技術とその応用を詳しく解説していきます。